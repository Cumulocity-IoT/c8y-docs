---
weight: 30
title: Single Device Registration 
layout: bundle
---

After enabling `extensibleDeviceRegistration` extension type, Device management > Devices > `Register Device` menu is being extended with entry named after extension `name` property:
![Select guide](/images/extensible-device-registration/register-device-menu-with-extensible-device-reg.png)

From now on everything will be rendered based in data provided via custom microservice. Added menu entry will open modal which is going to fetch the form definition using following endpoint:

{{< c8y-admon-info >}}
The context of the microservice, which is taken from application definition:
```
{
  "contextPath": "<relative path>",
  "availability": "MARKET",
  "type": "MICROSERVICE",
  "name": "<agent name>",
  ...
}```
{{< /c8y-admon-info >}}

`GET /service/<contextPath>/deviceRegistration/metadata&lang=<user-language>`

Example metadata definition:
```json
{
    "c8y_DeviceRegistration": {
      "title": "Example extensible registration",
      "description": "The required and optional properties to register and setup devices",
        "pages": [
            {
                "$schema": "https://json-schema.org/draft/2020-12/schema",
                "type": "object",
                "title": "Mandatory settings",
                "properties": {
                    "security": {
                      "default": "NO_SEC",
                      "type": "string",
                      "title": "Security mode",
                      "enum": [
                        "NO_SEC",
                        "SEC"
                      ]
                    },
                    "imei": {
                        "examples": [
                            "012345678901234"
                        ],
                        "type": "string",
                        "title": "Imei number"
                    }
                },
                "required": [
                    "imei",
                    "security"
                ]
            },
            {...}
        ]
    }
}
```
The important part is `pages` array which contains steps of the wizard that the modal is going to render accordingly to Json Schema definition: [https://json-schema.org/](https://json-schema.org/).
JSON Schema is a generic-purpose language to specify data, along with constraints and data types and simple validations.

As a result of following wizard will be displayed:
![Select guide](/images/extensible-device-registration/extensible-single-device-reg.png)

In the final step all data collected via the wizard will be sent back to the microservice using following rest endpoint:

`POST /service/<contextPath>/deviceRegistration`

```json
{
  "imei": "012345678901234",
  "security": "NO_SEC",
  ...
}
```

The form is able to send anything defined via JSON Schema standard and the microservis which provides the form definition is responsible to properly handle submitted data.

### API Specification

The device integration microservices have to implement following REST endpoints:


```
GET /service/<contextPath>/deviceRegistration/metadata?lang=<user-language>
Accept: application/json
```
Returns the metadata in the vocabulary of JSON Schema.


```
POST /service/<contextPath>/deviceRegistration
Content-type: application/json
```

Creates a single device based on the collected data. Sends application/json with key-value pairs.

### Single Device Registration flow diagram
![Single diagram](/images/extensible-device-registration/single-diagram.png)


